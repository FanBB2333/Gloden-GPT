
<div align=center ><img src="resources/logo.png" width="8%" /></div>


# 金融垂直大模型【智海-金磐大模型】

> 智海-金磐(Gloden-GPT)：金融垂直领域的国产大模型


## :scroll: 项目背景
**智海-金磐**是浙江大学和摸象科技联合发布的一个自主研发的垂直金融的语言大模型，目前模型规模7B和13B，可进一步扩展。训练的数据集垂直于零售金融方向，涵盖了金融知识图谱、金融文本、金融对话等多种数据源。

**金磐大模型**的目标是为金融机构提供高效、智能、可信赖的语言服务，包括金融知识问答、金融文本生成、金融对话机器人等多种应用场景。


下面的介绍会从**模型训练**、**模型增强**以及**模型评测**三个方面展开。

## :computer: 模型训练
大语言模型的训练分为两个阶段：

（1）在海量文本语料上的无监督预训练，学习通用的语义表示和世界知识。

（2）在小规模数据上，进行指令微调和基于人类反馈的强化学习，更好地对齐最终任务和人类偏好。

最新研究证明了LLM的几乎所有知识都是在预训练过程中学习到的，只需要有限的指令微调数据就可以生成高质量的回复。因此，基座模型的性能是至关重要的，目前，主流的开源大语言模型主要有三个：[**LLaMA**](https://github.com/facebookresearch/llama)、[**ChatGLM**](https://github.com/THUDM/ChatGLM-6B)和[**BLOOM**](https://huggingface.co/docs/transformers/model_doc/bloom)。下面从训练数据、tokenizer和模型结构上对这三个大语言模型进行比较。

| 模型       | 模型结构       | 训练数据                             | 训练数据量     | 模型参数量                       | 词表大小 |
| ---------- | -------------- | ------------------------------------ | -------------- | -------------------------------- | -------- |
| LLaMA      | Casual decoder | 以英语为主的拉丁语系，不包含中日韩文 | 1T/1.4T tokens | 7B、13B、33B、65B                | 32000    |
| ChatGLM-6B | Prefix decoder | 中英双语，中英文比例为1:1            | 1T tokens      | 6B                               | 130528   |
| Bloom      | Casual decoder | 46种自然语言和13种编程语言，包含中文 | 350B tokens    | 560M、1.1B、1.7B、3B、7.1B、176B | 250880   |


我们的模型基座是[LLaMA v1](https://github.com/facebookresearch/llama/tree/llama_v1)，在此基础上，进行了增量预训练以及指令微调训练。

### :rocket: 增量预训练

增量预训练的目的是给通用的大模型注入法律领域的知识。预训练的数据包括法律文书、司法案例以及法律问答数据，共40G。

### :dart: 指令微调训练




## :chart_with_upwards_trend: 模型增强

### :books: 知识库构建
<!-- ![Alt text](pics/知识库构建.png) -->
我们目前一共收集了5种类型的知识库，包括法条类、案例类、模板类、书籍类以及法律考试类。
1. **知识库收集与处理**
- 法条库
    + 法条库中包含了宪法、法律（宪法相关法、民商法、刑法、经济法、行政法、社会法、诉讼与非诉讼程序法）、司法解释、地方性法规（浙江、河南、北京、广东、重庆、山东、上海）、监察法规和行政法规。
    + 处理：输出为多个txt文件，其中刑法是json文件，key是标题，value是内容。
- 法律文书模版库
    + 法律文书模版库包含了民法、刑法和行政法三大部门法的起诉状、上诉状、法院判决书模版，以及合同等常用法律文书模版。
    + 处理：由于模版通常较长，因此通过ChatGPT总结得到文书模版的书写要点。最后得到一个json文件，key是文书标题，value是文书标题和要点。
- 法学书籍库
    + 法学书籍库涵盖了民法, 国际私法, 环境资源法, 法理学, 国际经济法, 中国特色社会主义法治理论, 民事诉讼法, 刑法, 刑事诉讼法, 司法制度和法律职业道德, 商法, 劳动与社会保障法, 宪法, 行政法与行政诉讼法, 国际法, 知识产权法, 经济法, 中国法律史等领域。
    + 处理：根据标题处理为多个txt文件以及与其对应的json文件，key是标题，value是内容。    
- 案例库
    + 案例库包含了刑法、民法领域中的大量案例。
    + 处理：由于案件事实通常较长，因此通过ChatGPT将案件事实总结成【主观动机】、【客观行为】以及【事外情节】三个部分。最后得到一个json文件，key是案件事实，value是事实和判决结果。
- 法考题库
    + 法考题库包含了2016年到2021年的1400题考题、选项、解析和答案。
    + 处理：一个json文件，key是问题，value是问题、选项、解析和答案。

2. **知识库存储**

- 任何一个知识点都是一个[key, value]的pair，其中key是该知识点的内容简介，用于检索，而value是知识点的具体内容，用于输入到模型中作为参考。

### :globe_with_meridians: 知识增强


## :clipboard: 模型评测


## :memo: 参考文献

- Wei, Bin, et al. "A full-process intelligent trial system for smart court." Frontiers of Information Technology & Electronic Engineering 23.2 (2022): 186-206.



